<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>The Internet of Roof Windows &#183; [blog@rolbk.com]#</title><meta name=title content="The Internet of Roof Windows &#183; [blog@rolbk.com]#"><meta name=description content="When your loft flat turns into a sauna every summer, the logical solution is obviously to reverse-engineer a decades-old proprietary bus protocol. A tale of digital archaeology, improvised level shifters, and ladder-based near-death experiences."><meta name=keywords content="IoT,ESPHome,Shelly Uni,Electronics,UART Abuse,Roof Windows,VELUX,"><link rel=canonical href=https://rolbk.com/posts/iot2-window/><link type=text/css rel=stylesheet href=/css/main.bundle.min.db15651319416dc23c09716c6bfad333663de46f0b1634dd77228e3d4e350ca3fbb38193699e7e36ded41b245e010f69c5d8428ef1646be3b37248366e6ee201.css integrity="sha512-2xVlExlBbcI8CXFsa/rTM2Y95G8LFjTddyKOPU41DKP7s4GTaZ5+Nt7UGyReAQ9pxdhCjvFka+Ozckg2bm7iAQ=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.a187118b41a60744310065c567365de85730c8495301d0ebae41810cc6f7a47432b1de7d4f3b11338959f1ac50c266be6b4b73acf6bf770016eb59b602cc1aa0.js integrity="sha512-oYcRi0GmB0QxAGXFZzZd6FcwyElTAdDrrkGBDMb3pHQysd59TzsRM4lZ8axQwma+a0tzrPa/dwAW61m2AswaoA==" data-copy=Copy data-copied=Copied></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://rolbk.com/posts/iot2-window/"><meta property="og:site_name" content="[blog@rolbk.com]#"><meta property="og:title" content="The Internet of Roof Windows"><meta property="og:description" content="When your loft flat turns into a sauna every summer, the logical solution is obviously to reverse-engineer a decades-old proprietary bus protocol. A tale of digital archaeology, improvised level shifters, and ladder-based near-death experiences."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-07T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-07T00:00:00+00:00"><meta property="article:tag" content="IoT"><meta property="article:tag" content="ESPHome"><meta property="article:tag" content="Shelly Uni"><meta property="article:tag" content="Electronics"><meta property="article:tag" content="UART Abuse"><meta property="article:tag" content="Roof Windows"><meta property="og:image" content="https://rolbk.com/posts/iot2-window/featured.webp"><meta property="og:see_also" content="https://rolbk.com/posts/iot4-heislberg/"><meta property="og:see_also" content="https://rolbk.com/posts/iot3-door/"><meta property="og:see_also" content="https://rolbk.com/posts/iot1-sofa/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rolbk.com/posts/iot2-window/featured.webp"><meta name=twitter:title content="The Internet of Roof Windows"><meta name=twitter:description content="When your loft flat turns into a sauna every summer, the logical solution is obviously to reverse-engineer a decades-old proprietary bus protocol. A tale of digital archaeology, improvised level shifters, and ladder-based near-death experiences."><meta name=twitter:image content="https://rolbk.com/posts/iot2-window/featured.webp"><meta property="og:image" content="https://rolbk.com/posts/iot2-window/featured.webp"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"The Internet of Roof Windows","headline":"The Internet of Roof Windows","abstract":"When your loft flat turns into a sauna every summer, the logical solution is obviously to reverse-engineer a decades-old proprietary bus protocol. A tale of digital archaeology, improvised level shifters, and ladder-based near-death experiences.","inLanguage":"en","url":"https:\/\/rolbk.com\/posts\/iot2-window\/","author":{"@type":"Person","name":"Emanuel Mairoll"},"copyrightYear":"2023","dateCreated":"2023-01-07T00:00:00\u002b00:00","datePublished":"2023-01-07T00:00:00\u002b00:00","dateModified":"2023-01-07T00:00:00\u002b00:00","keywords":["IoT","ESPHome","Shelly Uni","Electronics","UART Abuse","Roof Windows","VELUX"],"mainEntityOfPage":"true","wordCount":"4046"}]</script><meta name=author content="Emanuel Mairoll"><link href=https://github.com/rolbk/ rel=me><link href=https://www.linkedin.com/in/rolbk/ rel=me><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link type=text/css rel=stylesheet href=/lib/lite-youtube-embed/lite-yt-embed.badabc6055b427669bbcf084097334cdf2029c85696c4a56e25239825d3571d26ef82b775ba19032ccd52135ccb412c9ba79da4e9e9b6f3939a6178a5f65ee5d.css integrity="sha512-utq8YFW0J2abvPCECXM0zfICnIVpbEpW4lI5gl01cdJu+Ct3W6GQMszVITXMtBLJunnaTp6bbzk5pheKX2XuXQ=="><script type=text/javascript src=/lib/lite-youtube-embed/lite-yt-embed.58a8a22aed9d1cd05780869df4b0d87972fcd144a9eaff8f9a1453e58e6521c5a89ccd80bdb9f48e25ae5ee87b98bd9de51b14dd9988c60e4c89630433292084.js integrity="sha512-WKiiKu2dHNBXgIad9LDYeXL80USp6v+PmhRT5Y5lIcWonM2Avbn0jiWuXuh7mL2d5RsU3ZmIxg5MiWMEMykghA=="></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">[blog@rolbk.com]#</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Posts>Posts</p></a><a href=/projects/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title="Under Construction ;-)">Projects</p></a><a href=/resume/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Resume>Resume</p></a><a href=/posts/index.xml class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM128 416c0 35.3-28.7 64-64 64S0 451.3.0 416s28.7-64 64-64 64 28.7 64 64zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></span><p class="text-base font-medium" title></p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Posts>Posts</p></a></li><li class=mt-1><a href=/projects/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title="Under Construction ;-)">Projects</p></a></li><li class=mt-1><a href=/resume/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Resume>Resume</p></a></li><li class=mt-1><a href=/posts/index.xml class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM128 416c0 35.3-28.7 64-64 64S0 451.3.0 416s28.7-64 64-64 64 28.7 64 64zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></div><p class="text-bg font-bg" title></p></a></li></ul></div></div></div></div></div></div><script type=text/javascript src=/js/background-blur.min.0ad33cb9c066f652728b2cc09c9ceaf32645544f48e8b6b38f120d86f433ed997da275a49e6151fe0176430c45376812708d84727f3f969101fb44a4345b3f34.js integrity="sha512-CtM8ucBm9lJyiyzAnJzq8yZFVE9I6LazjxINhvQz7Zl9onWknmFR/gF2QwxFN2gScI2Ecn8/lpEB+0SkNFs/NA==" data-target-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/posts/iot2-window/featured_hu_788b7ee84b568ec8.webp alt="Background Image" class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script type=text/javascript src=/js/background-blur.min.0ad33cb9c066f652728b2cc09c9ceaf32645544f48e8b6b38f120d86f433ed997da275a49e6151fe0176430c45376812708d84727f3f969101fb44a4345b3f34.js integrity="sha512-CtM8ucBm9lJyiyzAnJzq8yZFVE9I6LazjxINhvQz7Zl9onWknmFR/gF2QwxFN2gScI2Ecn8/lpEB+0SkNFs/NA==" data-target-id=background-blur data-image-id=background-image data-image-url=/posts/iot2-window/featured.webp></script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">The Internet of Roof Windows</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2023-01-07T00:00:00+00:00>7 January 2023</time><span class="px-2 text-primary-500">&#183;</span><span>4046 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">19 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] mr-2" href=/tags/iot/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">IoT
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/esphome/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">ESPHome
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/shelly-uni/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Shelly Uni
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/electronics/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Electronics
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/uart-abuse/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">UART Abuse
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/roof-windows/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Roof Windows
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/velux/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">VELUX</span></span></a></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#the-itch>The Itch</a></li><li><a href=#the-velux-integra-research-rabbit-hole>The VELUX Integra Research Rabbit Hole</a></li><li><a href=#the-parade-of-failed-ideas>The Parade of Failed Ideas</a><ul><li><a href=#the-open-source-community>The Open-Source Community</a></li><li><a href=#maybe-these-overpriced-modern-products>Maybe These Overpriced Modern Products?</a></li><li><a href=#power-cycling-automation>Power Cycling Automation</a></li><li><a href=#the-ir-remote-control>The IR Remote Control</a></li><li><a href=#the-proprietary-wired-bus>The Proprietary Wired Bus</a></li></ul></li><li><a href=#the-archaeology-begins>The Archaeology Begins</a></li><li><a href=#the-logic-analyzer-saga>The Logic Analyzer Saga</a></li><li><a href=#the-protocol-that-shall-not-be-named>The Protocol That Shall Not Be Named</a></li><li><a href=#the-most-cursed-uart-abuse-ever>The Most Cursed UART Abuse Ever</a></li><li><a href=#testing-the-cursed-theory>Testing the Cursed Theory</a></li><li><a href=#the-permanent-installation-challenge>The Permanent Installation Challenge</a><ul><li><a href=#meet-the-shelly-uni>Meet the Shelly Uni</a></li><li><a href=#the-cursed-electronics>The Cursed Electronics</a></li><li><a href=#the-cursed-test-setup>The Cursed Test Setup</a></li></ul></li><li><a href=#installation-day>Installation Day</a></li><li><a href=#the-configuration>The Configuration</a></li><li><a href=#the-verdict>The Verdict</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#the-itch>The Itch</a></li><li><a href=#the-velux-integra-research-rabbit-hole>The VELUX Integra Research Rabbit Hole</a></li><li><a href=#the-parade-of-failed-ideas>The Parade of Failed Ideas</a><ul><li><a href=#the-open-source-community>The Open-Source Community</a></li><li><a href=#maybe-these-overpriced-modern-products>Maybe These Overpriced Modern Products?</a></li><li><a href=#power-cycling-automation>Power Cycling Automation</a></li><li><a href=#the-ir-remote-control>The IR Remote Control</a></li><li><a href=#the-proprietary-wired-bus>The Proprietary Wired Bus</a></li></ul></li><li><a href=#the-archaeology-begins>The Archaeology Begins</a></li><li><a href=#the-logic-analyzer-saga>The Logic Analyzer Saga</a></li><li><a href=#the-protocol-that-shall-not-be-named>The Protocol That Shall Not Be Named</a></li><li><a href=#the-most-cursed-uart-abuse-ever>The Most Cursed UART Abuse Ever</a></li><li><a href=#testing-the-cursed-theory>Testing the Cursed Theory</a></li><li><a href=#the-permanent-installation-challenge>The Permanent Installation Challenge</a><ul><li><a href=#meet-the-shelly-uni>Meet the Shelly Uni</a></li><li><a href=#the-cursed-electronics>The Cursed Electronics</a></li><li><a href=#the-cursed-test-setup>The Cursed Test Setup</a></li></ul></li><li><a href=#installation-day>Installation Day</a></li><li><a href=#the-configuration>The Configuration</a></li><li><a href=#the-verdict>The Verdict</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-fit"><details class="mt-2 mb-5 overflow-hidden rounded-lg ltr:ml-0 ltr:pl-5 rtl:mr-0 rtl:pr-5"><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">The Open Source Smart Home -
This article is part of a series.</summary><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=/posts/iot1-sofa/>Part 1:
The Internet of Furniture</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">Part 2:
This Article</div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=/posts/iot3-door/>Part 3:
The Internet of Entrance Doors</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=/posts/iot4-heislberg/>Part 4:
Heislberg: The Internet of Toilets</a></div></details><div class="article-content max-w-prose mb-20"><p><strong><em>Stories from the Open Source Smart Home - Part 2</em></strong></p><hr><h2 class="relative group">The Itch<div id=the-itch class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-itch aria-label=Anchor>#</a></span></h2><p>Back in my Salzburg days, I lived in an absolutely wonderful loft flat. Ten minutes from the city, gorgeous views, an amazing neighborhood, and a landlord who lived below me who basically treated me as family - the kind of relationship where you&rsquo;d have dinner together and chat about life. The flat itself was amazing, bright and spacious with high ceilings, and had a beautiful traditional wooden interior.</p><p>And most importantly: Electrically operated roof windows that opened directly to the starlit night sky.</p><p>There was just one thing. The day I moved in, holding that crusty remote control from 2002, I felt it.</p><p><em>The itch.</em></p><p>The urge of automation, the urge of IoT-fying something that probably shouldn&rsquo;t be IoT-fied.</p><p>You see, the flat did get quite warm in summer&mldr; like <em>seriously</em> warm, as loft flats do. Being able to automatically open windows based on temperature sensors or time schedules would be&mldr; useful? Sure, let&rsquo;s go with useful. Definitely not just an excuse to reverse-engineer a two-decade-old proprietary protocol.</p><p>Because obviously, the solution to a warm apartment isn&rsquo;t just opening the windows manually like a normal person. It&rsquo;s spending months teaching them to open themselves.</p><p><em>How hard could it be?</em></p><p>(Narrator: It was hard.)</p><h2 class="relative group">The VELUX Integra Research Rabbit Hole<div id=the-velux-integra-research-rabbit-hole class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-velux-integra-research-rabbit-hole aria-label=Anchor>#</a></span></h2><p>My roof windows were VELUX Integra units, installed when the attic was converted around 2002. Finding ANY technical information about these specific models was like digital archaeology. VELUX&rsquo;s website didn&rsquo;t even acknowledge their existence, and customer support helpfully informed me that my model was &ldquo;discontinued&rdquo; and suggested I buy an entirely new window system.</p><p>Hours of googling led me through installation manuals in German, Italian, French, and what I&rsquo;m pretty sure was Dutch. Each manual referenced different model numbers, different control
systems, and absolutely none of them matched what I had (I think?).</p><p>Seriously, try to reverse engineer <em>anything</em> from a manual looking like a 1980 comic book:</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=manual srcset="/posts/iot2-window/manual_hu_2cdf8ec3bc05c39c.png 330w,
/posts/iot2-window/manual_hu_ae0c857961c41879.png 660w,
/posts/iot2-window/manual_hu_4c7c82dd71289b20.png 1280w" data-zoom-src=/posts/iot2-window/manual.png src=/posts/iot2-window/manual.png></figure></p><p>Luckily, I found one German webshop (<a href=https://meurer-shop.de target=_blank>meurer-shop.de</a>) that still listed vintage VELUX parts. That&rsquo;s when I discovered the replacement components for my system and nearly had a heart attack:</p><ul><li><strong>WCM 531</strong> The IR control board in a small white box on my window (115€ and out of stock)</li><li><strong>WLR 100</strong> My infrared remote control (130€ and out of stock)</li><li><strong>WLC 100</strong> A mysterious &ldquo;control unit&rdquo; I didn&rsquo;t have, best described as a large box with a &ldquo;bus interface&rdquo; (250€ and also out of stock)</li><li><strong>WLI 130</strong> A small keypad that could be attached to the WLC (110€ and, you guessed it, out of stock)</li></ul><p>The bottom line was:</p><ol><li>Everything was crazy expensive</li><li>I had no clue if any of these would actually work with my very specific 2002 window variant</li><li>Even if I wanted to throw money at the problem, I couldn&rsquo;t - everything was perpetually out of stock</li></ol><p>The WLC unit caught my attention though. The description showed a &ldquo;3-wire bus for system integration.&rdquo; Interesting&mldr;</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="3 wire bus" srcset="/posts/iot2-window/3wire_hu_18ca571e5b8de0a4.jpg 330w,
/posts/iot2-window/3wire_hu_c739c8987e90e2a7.jpg 660w,
/posts/iot2-window/3wire_hu_bc2119205f3b12c5.jpg 1280w" data-zoom-src=/posts/iot2-window/3wire.jpg src=/posts/iot2-window/3wire.jpg></figure></p><h2 class="relative group">The Parade of Failed Ideas<div id=the-parade-of-failed-ideas class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-parade-of-failed-ideas aria-label=Anchor>#</a></span></h2><h3 class="relative group">The Open-Source Community<div id=the-open-source-community class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-open-source-community aria-label=Anchor>#</a></span></h3><p>Surely someone, somewhere, made a universal remote for these windows? I scoured several electronics forums, browsed the Home Assistant community, and checked DIY electronics marketplaces like tindie.com. Althrough there were quite a few projects for the newer KLR 200 and 300, no one seemed to have tackled the ancient Integra series.</p><h3 class="relative group">Maybe These Overpriced Modern Products?<div id=maybe-these-overpriced-modern-products class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#maybe-these-overpriced-modern-products aria-label=Anchor>#</a></span></h3><p>I spent hours researching if any of VELUX&rsquo;s current (overpriced) smart home products would work with my ancient window. There were adapters for their newer io-homecontrol system, but those were built for the generation after my window. If they were backwards compatible? The answer was a resounding &ldquo;maybe, but probably not, but we won&rsquo;t tell you for sure, please buy it and find out.&rdquo;</p><p>Risk 300€ on a maybe? Pass.</p><h3 class="relative group">Power Cycling Automation<div id=power-cycling-automation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#power-cycling-automation aria-label=Anchor>#</a></span></h3><p>Maybe I could control it by cutting power? I opened every electrical installation box in my flat (multiple times), traced cables, flipped breakers - both to find if I&rsquo;d missed any hidden control boxes somewhere, and to check if I could just cut and restore power to trigger some default behavior.</p><p>The window didn&rsquo;t care. It just sat there, judging me.</p><h3 class="relative group">The IR Remote Control<div id=the-ir-remote-control class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-ir-remote-control aria-label=Anchor>#</a></span></h3><p>Now we&rsquo;re getting somewhere! I grabbed my Flipper Zero and quickly captured the IR signals of the remote. A few button presses later, I could replay them perfectly. The window obediently opened and closed at my command. Victory?</p><p>Well&mldr; not quite. IR control meant I was basically building a glorified universal remote. No feedback about whether the window was actually open or closed. No way to know if the command succeeded. Plus, IR requires line of sight - meaning I&rsquo;d need the controller mounted somewhere visible, forever staring at me, silently judging my half-hearted attempt at &ldquo;automation.&rdquo;</p><p>I even found an IR-enabled smart plug that could learn and replay signals. I could have plugged it in near the window, connected it to Home Assistant, and called it a day.</p><p>Functional? Maybe&mldr; But where was the challenge? The complexity? The months of obsessive debugging? This felt like cheating on an exam by actually studying - technically correct but emotionally hollow.</p><hr><h3 class="relative group">The Proprietary Wired Bus<div id=the-proprietary-wired-bus class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-proprietary-wired-bus aria-label=Anchor>#</a></span></h3><p>Some of these solutions were probably technically functional but deeply unsatisfying to my engineering soul.</p><p>So I kept digging throgh <a href=https://web.archive.org/web/20250911153605/https://www.meurer-shop.de/media/files_public/d8bf5d380b6ff5c3e3242802b04bc329/WLC%20100.pdf target=_blank>manuals</a>, and kept kept seeing references to this weird three-color bus system. Red, blue, yellow wires that could supposedly connect multiple windows together to&mldr; daisy chain them? Open them simultaneously? Integrate them with some mysterious WLC control unit?</p><p>A proprietary bus protocol from 2002? Hidden inside my wall? Undocumented and forgotten by time?</p><p><em>Ah shit, here we go again.</em></p><h2 class="relative group">The Archaeology Begins<div id=the-archaeology-begins class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-archaeology-begins aria-label=Anchor>#</a></span></h2><p>Remember those replacement parts? 115€ for a control board, 130€ for a remote - and all perpetually out of stock? Meaning if I messed up there would basically be no way of recovery?</p><p>So anyways, I grabbed my screwdriver and a ladder and began the ascent. The mysterious three-color bus was calling to me. But to understand it, I&rsquo;d need to get intimate with the control box - which meant removing it from its home three meters up on my roof window.</p><p>Two screws held the white control box to the window frame. Simple enough, except when you&rsquo;re balanced on top of a ladder, trying not to think about the drop to very hard Austrian floor tiles below.<br>First screw: Easy.<br>Second screw&mldr; Why is it always the second screw that strips?</p><p>After some creative German vocabulary and careful persuasion with pliers, the box came free. The connector unplugged surprisingly easily - clearly designed for maintenance, unlike literally everything else about this system.</p><p>Back on solid ground, I cracked open the control box and felt like I was entering a time capsule. Through-hole components! Actual-size resistors you could read without a microscope! Chips with date codes older than me!</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=board srcset="/posts/iot2-window/board_hu_b1009cb0d44b7fcb.webp 330w,
/posts/iot2-window/board_hu_c898d4f00488fa17.webp 660w,
/posts/iot2-window/board_hu_3699ab181a025f18.webp 1280w" data-zoom-src=/posts/iot2-window/board.webp src=/posts/iot2-window/board.webp></figure></p><p>(Yes, those funny wires you see on the left weren&rsquo;t original - I&rsquo;d already started my investigation by the time I thought to take photos. Documentation was never my strong suit.)</p><p>And there they were: six connectors, split into two groups of three. One set labeled &ldquo;INT&rdquo; (internal?), another labeled &ldquo;EXT&rdquo; (external?). The three-color bus from the manual - red, blue, and yellow - times two.</p><p>After staring at the board for probably too long, I started tracing the lines:</p><p><strong>The Reds:</strong> Both red wires (INT and EXT) traced directly to ground. Easy win. At least something in this project would be straightforward.<br><strong>The Yellows:</strong> Both yellow wires were connected together connected through a RC filter and a diode to&mldr; ground, I think? Shielding probably?<br><strong>The Blues:</strong> This is where it got interesting. The blue INT directly connected to a open drain MOSFET circuit (so output probably) before connecting to a chip labeled &ldquo;WLI&rdquo; - hey, same label as the wall mounted keypad! The blue EXT wire went to a different PCB area and connected to a diode and RC filter, before going to an opamp chip comparing it to ground (so presumably input, to be pulled down?).</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="The frond side" srcset="/posts/iot2-window/traced_front_hu_c1f53ad22a0a1fc3.webp 330w,
/posts/iot2-window/traced_front_hu_dd6df71c469853d.webp 660w,
/posts/iot2-window/traced_front_hu_5b34b2aaa0451f3e.webp 1280w" data-zoom-src=/posts/iot2-window/traced_front.webp src=/posts/iot2-window/traced_front.webp></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="The back side" srcset="/posts/iot2-window/traced_back_hu_74a20faeef6bdd47.webp 330w,
/posts/iot2-window/traced_back_hu_6ffecab133c03787.webp 660w,
/posts/iot2-window/traced_back_hu_136b5befb22f004.webp 1280w" data-zoom-src=/posts/iot2-window/traced_back.webp src=/posts/iot2-window/traced_back.webp></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="The comparator island" srcset="/posts/iot2-window/traced_comp_hu_82105107513f80da.webp 330w,
/posts/iot2-window/traced_comp_hu_3da31dcc7a6fa2b3.webp 660w,
/posts/iot2-window/traced_comp_hu_9ece657fb93bb1a.webp 1280w" data-zoom-src=/posts/iot2-window/traced_comp.webp src=/posts/iot2-window/traced_comp.webp></figure></p><p>There was also another connector - the one going to the motor unit. I wasn&rsquo;t particularly interested in that one, but I did need to know the supply voltage. After checking the pinout, I traced the leftmost pin as it ran into an LM317S voltage regulator. That&rsquo;s the pin I soldered the small red cable onto that you can see in the photos above - my improvised test point for power measurements.</p><p>Armed with this knowledge, it was time for another ladder adventure. Picture me, three meters up, multimeter balanced on the top of the ladder, probes in both hands, trying to measure voltages on a live circuit while desperately not shorting anything that would kill my irreplaceable control board.</p><p>The supply voltage read 19.77V. Very particular value indeed.</p><p>And for the bus: Red connectors were indeed ground, yellow connectors seemed to be as well (supporting the shielding theory). But the blue connectors - that&rsquo;s where things got interesting.</p><p>The INT blue connector sat at 5.17V when idle, but when I pressed the remote - bingo - it would briefly pulse with <em>something</em> before settling back down. The EXT blue connector was being more mysterious, barely giving me any readable signal.</p><p>So there it was: A communication bus with separate internal and external connections. VELUX had built their own proprietary network protocol, hidden it inside these control boxes, and then conveniently &ldquo;forgot&rdquo; to document how it worked after discontinuing the product line.</p><h2 class="relative group">The Logic Analyzer Saga<div id=the-logic-analyzer-saga class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-logic-analyzer-saga aria-label=Anchor>#</a></span></h2><p>Time to science this thing. I ordered a cheap 8-channel logic analyzer from Amazon (an AZ Delivery one - 15 euros of pure debugging power) and prepared for some signal sniffing while the thing was connected.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=cable srcset="/posts/iot2-window/cable_hu_873f7ad7e7e14ffa.webp 330w,
/posts/iot2-window/cable_hu_423f69777d895365.webp 660w,
/posts/iot2-window/cable_hu_92619ddbce807a80.webp 1280w" data-zoom-src=/posts/iot2-window/cable.webp src=/posts/iot2-window/cable.webp></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="logic analyzer" srcset="/posts/iot2-window/logic_analyzer_hu_5c9470102cf27173.webp 330w,
/posts/iot2-window/logic_analyzer_hu_4a563da08184dca5.webp 660w,
/posts/iot2-window/logic_analyzer_hu_64a40ebfb8097b12.webp 1280w" data-zoom-src=/posts/iot2-window/logic_analyzer.webp src=/posts/iot2-window/logic_analyzer.webp></figure></p><p>Now, connecting a 3000€ MacBook to a mains-connected roof window of indeterminate value through a 15€ funky logic analyzer required some&mldr; precautions.</p><p>So I:</p><ol><li>Checked the wiring for every cable with a multimeter (twice)</li><li>Tested for unexpected voltage differences before connecting anything</li><li>Disconnected the MacBook from power (galvanic isolation, baby!)</li><li>Grounded myself to the common ground (static discharge prevention)</li><li>Prayed to the electronics gods</li><li>Plugged in the USB cable</li></ol><p>First, I connected to the EXT bus. Nothing. Flatlines while the window cheerfully opened and closed. So maybe EXT <em>was</em> in fact for daisy-chaining to other windows?</p><p>So I tried the INT bus instead.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="signal captured" srcset="/posts/iot2-window/signal_captured_hu_42eadc8d1ea3ff49.png 330w,
/posts/iot2-window/signal_captured_hu_4e389fd61cd14e7b.png 660w,
/posts/iot2-window/signal_captured_hu_2539c26668d7783.png 1280w" data-zoom-src=/posts/iot2-window/signal_captured.png src=/posts/iot2-window/signal_captured.png></figure></p><p>Success! When I pressed the remote, beautiful digital signals appeared. Sequences of pulses that clearly meant <em>something</em>. But what?</p><h2 class="relative group">The Protocol That Shall Not Be Named<div id=the-protocol-that-shall-not-be-named class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-protocol-that-shall-not-be-named aria-label=Anchor>#</a></span></h2><p>The protocol wasn&rsquo;t I2C. It wasn&rsquo;t SPI. It wasn&rsquo;t Manchester encoding. It was&mldr; something else entirely. After clicking through every protocol decoder in my logic analyzer software, I finally looked at the raw waveform.</p><p>It was a pulse width modulated protocol. Default high, with fixed-width symbols of 1.7ms each. The low time varied between two values: 1.3ms (76% duty cycle) and 0.5ms (30% duty cycle).</p><p>I designated 76% duty as binary 0 and 30% duty as binary 1. Then, i decoded the bit patterns by hand (yes, by hand, with a notepad like some kind of digital archaeologist).</p><p>Each command was a specific sequence repeated twice:</p><pre tabindex=0><code>Motor 1 (window), All windows of control group:
* Open:  010101 111101  010101 111101
* Stop:  010110 011111  010110 011111
* Close: 010101 101111  010101 101111
</code></pre><p>Since the messages seemed stable, I figured that I didn&rsquo;t actually have to &ldquo;understand&rdquo; the protocol. There was probably addressing scheme or checksum, but I didn&rsquo;t care - I just needed to replicate these exact sequences.</p><p>But how do you read or even generate a duty cycle protocol with an ESP?</p><h2 class="relative group">The Most Cursed UART Abuse Ever<div id=the-most-cursed-uart-abuse-ever class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-most-cursed-uart-abuse-ever aria-label=Anchor>#</a></span></h2><p>Here&rsquo;s where things got properly cursed.</p><p>I could have implemented proper duty cycle generation. I could have used PWM. I could have bitbanged it properly with precise timing.</p><p>Or&mldr; I could abuse UART.</p><p>Think about it: UART sends bits as high and low signals. A &lsquo;1&rsquo; bit is high, a &lsquo;0&rsquo; bit is low. If you send 0xFF, you get 8 high bits. If you send 0x00, you get 8 low bits. And if you choose your baud rate <em>just right</em>, you can make UART generate duty cycles that look like your protocol.</p><p>I started playing with the UART decoder in my logic analyzer, trying different baud rates to find one where the duty cycle patterns would consistently map to specific byte values.</p><p>At 5924 baud (a number that appears in no UART tables whatsoever) magic happened:</p><ul><li>The 21% duty cycle bits decoded as 0x80</li><li>The 69% duty cycle bits decoded as 0xFC</li></ul><p>The entire protocol could now be treated as weird UART messages. I didn&rsquo;t need to understand the protocol encoding, or implement a proper decoder - I just needed to send the right sequence of &ldquo;wrong&rdquo; UART bytes that would produce the correct duty cycle pattern.</p><p>I basically looked at my ESP&rsquo;s UART peripheral and said: &ldquo;You&rsquo;re a duty cycle generator now.&rdquo;</p><h2 class="relative group">Testing the Cursed Theory<div id=testing-the-cursed-theory class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#testing-the-cursed-theory aria-label=Anchor>#</a></span></h2><p>Armed with this absolutely unhinged approach, I grabbed my trusty Wemos D1 Mini and wrote the simplest possible test:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Serial.begin(<span style=color:#ae81ff>5924</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// Listen on INT bus
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>while</span>(Serial.available()) {
</span></span><span style=display:flex><span>  byte b <span style=color:#f92672>=</span> Serial.read();
</span></span><span style=display:flex><span>  Serial.print(b, HEX);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Connected it to the INT bus through a level shifter (because 5.17V into 3.3V logic = magic smoke), and pressed the remote.</p><p>It worked! The ESP happily received bytes from the duty cycle protocol, thinking it was just really weird UART.</p><lite-youtube videoid=og9LxxJ2h9U playlabel=og9LxxJ2h9U params></lite-youtube><p>Now for the real test. I connected another wire from the ESP to the EXT bus (again through a level shifter), and tried replaying what I&rsquo;d received:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Serial.begin(<span style=color:#ae81ff>5924</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// &#34;Open&#34; command in our cursed UART interpretation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Serial.write(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x80\xFC\x80\xFC\x80\xFC\xFC\xFC\xFC\xFC\x80\xFC</span><span style=color:#e6db74>&#34;</span>);
</span></span></code></pre></div><p>I uploaded the code, held my breath, and ran it.</p><p><em>The window opened.</em></p><p>I stood there for a solid minute, staring at my roof window as it slowly extended, controlled by two lines of code. Months of research. Dozens of manuals in various languages. A ladder-based near-death experience.</p><p>I had successfully gaslit an ESP8266 into speaking a proprietary 2002 duty cycle protocol by abusing UART at a nonsensical baud rate. This is either genius or madness. Probably both.</p><lite-youtube videoid=tnYLu9EDrmo playlabel=tnYLu9EDrmo params></lite-youtube><h2 class="relative group">The Permanent Installation Challenge<div id=the-permanent-installation-challenge class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-permanent-installation-challenge aria-label=Anchor>#</a></span></h2><p>Now for the hard part: making it permanent and invisible. The requirements were daunting:</p><ul><li>Must fit inside (or very close to) the control box</li><li>ESP-based (so 3.3V internally)</li><li>Handle the board&rsquo;s 19.77V supply voltage</li><li>Interface with 5.17V bus signals</li><li>Ideally not burn down my apartment</li></ul><h3 class="relative group">Meet the Shelly Uni<div id=meet-the-shelly-uni class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#meet-the-shelly-uni aria-label=Anchor>#</a></span></h3><p>After considering various ESP boards, I discovered the Shelly Uni - essentially the perfect implant for retrofitting dumb devices:</p><ul><li>Tiny footprint (smaller than a matchbox)</li><li>Accepts 12-36V DC supply voltage</li><li>Two Built-in optocouplers for potential-free outputs</li><li>2 GPIOs exposed for custom use, tolerant up to 24V</li><li>ESP8266 based (hello, ESPHome!)</li><li>Costs less than a decent pizza</li></ul><p>The only problem? Documentation.</p><p>Now, I usually appreciate Shelly&rsquo;s open-source friendliness - they add reflashing headers to their devices and officially support Home Assistant integration. But the documentation for the Uni? Let&rsquo;s just say it was&mldr; sparse. They provided wiring examples that would work with their official firmware, sure. But a board schematic? ESP GPIO pinout mapping? Any details about what connects to what internally? Nope.</p><p>Thankfully, the Tasmota community (ESPHome&rsquo;s &ldquo;competitor&rdquo; in the custom firmware space) had already done the hard work. They&rsquo;d reverse-engineered the entire pinout through careful probing and documented everything. GPIO4 and GPI15 for the optocouplers, GPIO17 for ADC input, GPIO0 for the onboard LED - all meticulously mapped out.</p><p>After acquiring a programming adapter for the 1.27mm pitch headers (they had to keep it compact somehow), I could finally flash ESPHome onto it using the Tasmota-documented pinout.</p><p><em>Funny sidenote: Did you know you can use a Wemos D1 mini as UART adapter? I somehow managed to fry my dedicated USB-to-serial adapter, so I improvised by wiring another Wemos&rsquo; RX/TX pins to the Shelly&rsquo;s programming header. You just need to tape down the reset button on the Wemos, and it works perfectly. Though I wouldn&rsquo;t recommend it as a long-term solution.</em></p><h3 class="relative group">The Cursed Electronics<div id=the-cursed-electronics class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-cursed-electronics aria-label=Anchor>#</a></span></h3><p>I needed to:</p><p><strong>For writing to the bus (ESP to Window):</strong> The Shelly&rsquo;s optocouplers were perfect. I could just use them to pull down the INT to ground as needed. Simple, safe, and effective.</p><p><strong>For reading from the bus (Window to ESP):</strong> This is where things got&mldr; creative.</p><p>I somehow needed to step down the 5.17V signal to 3.3V for the ESP&rsquo;s GPIO. Technically, the board GPIO pins can tolerate up to 24V, but as said - there is no documentation on <em>how</em> thats done. I tried to trace the internal circuitry, but the PCB was so tiny and densely packed that I couldn&rsquo;t be sure.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="shelly front" srcset="/posts/iot2-window/shelly_front_hu_9a3de3ae740e0b6c.webp 330w,
/posts/iot2-window/shelly_front_hu_6b5282c19e843d8.webp 660w,
/posts/iot2-window/shelly_front_hu_f1f65357e9b3cf31.webp 1280w" data-zoom-src=/posts/iot2-window/shelly_front.webp src=/posts/iot2-window/shelly_front.webp></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="shelly back" srcset="/posts/iot2-window/shelly_back_hu_3ad1a22e0e0b88e2.webp 330w,
/posts/iot2-window/shelly_back_hu_716fe89347d8d581.webp 660w,
/posts/iot2-window/shelly_back_hu_ba7c0833835fac8e.webp 1280w" data-zoom-src=/posts/iot2-window/shelly_back.webp src=/posts/iot2-window/shelly_back.webp></figure></p><p>Remember, if I somehow managed to connect anything higher than the 5.17V to the EXT bus (something something pullup resistor to supply voltage), I could potentially damage the entire window control board. Not an option.</p><p>So instead I decided to play it safe and use my own level shifting solution, while somehow keeping it tiny enough to fit inside the cramped control box.</p><p>Question: What is the simplest, smallest, cheapest level shifter you can think of?</p><p>A small TTL chip? <em>Easier</em></p><p>A voltage divider with two resistors? <em>Easier</em></p><p>My solution? A single inline Zener diode.</p><p>That&rsquo;s right. I used a 1.7V Zener diode as the world&rsquo;s jankiest level shifter. The 5.17V signal from the board hits the diode, gets shifted to 3.3V, feeds directly into the ESP&rsquo;s GPIO. One component. Maximum curse. Minimum dignity.</p><h3 class="relative group">The Cursed Test Setup<div id=the-cursed-test-setup class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-cursed-test-setup aria-label=Anchor>#</a></span></h3><p>Before committing to the permanent installation, I had to test the entire setup on my desk. So I had <em>another</em> D1 mini to simulate the window bus, sending the same UART commands I had recorded earlier.</p><p>The setup was ridiculous:</p><ul><li>The D1 mini sending commands through a proper level shifter (up to 5V)</li><li>Those signals going through my cursed Zener &ldquo;level shifter&rdquo; (back to 3.3V)</li><li>Into the Shelly Uni ESP running ESPHome</li><li>It answering back through its optocoupler (pulling the INT bus low)</li><li>Into the D1 Mini for verification</li><li>While another D1 Mini served as serial bridge for debugging output of the Shelly</li></ul><p>Yes, I was using two ESPs to test another ESP. Yes, this was probably the most over-instrumented roof window in Austria. No, I have no regrets.</p><p>This is at least cleaned up a little bit, after I acquired another USB-to-serial adapter to replace my fried one:</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="test setup" srcset="/posts/iot2-window/test_setup_hu_c577d942480d5c84.webp 330w,
/posts/iot2-window/test_setup_hu_15c1cae3d2777037.webp 660w,
/posts/iot2-window/test_setup_hu_e1dce29b4017c33b.webp 1280w" data-zoom-src=/posts/iot2-window/test_setup.webp src=/posts/iot2-window/test_setup.webp></figure></p><p>Miraculously, nothing released the magic smoke. The Zener diode, despite being the electronic equivalent of using a hammer as a screwdriver, worked perfectly.</p><h2 class="relative group">Installation Day<div id=installation-day class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#installation-day aria-label=Anchor>#</a></span></h2><p>After weeks of testing on my desk with increasingly long cables snaking through my flat (at one point I had a 5-meter USB cable running from my desk to the window for &ldquo;convenience&rdquo;), it was time for the final installation.</p><p>The beauty of all my preparation was that the actual installation would be surprisingly straightforward. No soldering iron balanced on a ladder, no hair-thin wires to attach while three meters up. Everything was pre-wired, pre-configured, and ready to go.</p><p>First things first: power off at the breaker. Learning had occurred.</p><p>Back up the ladder one last time, I opened the control box and surveyed my target. The Shelly Uni, already flashed with my ESPHome config, had all its connections ready:</p><ul><li>Power supply wire to my pre-soldered red test point (19.77V)</li><li>Ground to one of the red ground connectors</li><li>Optocoupler output (GPIO15) between ground and the EXT blue connector (for sending commands)</li><li>The cursed Zener diode (already soldered inline with the Shelly&rsquo;s GPIO05 blue wire) to the INT blue connector (for receiving commands)</li></ul><p>I connected everything methodically, double-checked each connection, triple-checked I hadn&rsquo;t created any shorts, then climbed back down and walked to the breaker box.</p><p>The moment of truth. I flipped the breaker.</p><p><strong>First observation:</strong> No magic smoke. Always a good start.</p><p><strong>Second observation:</strong> The Shelly&rsquo;s LED was blinking happily, broadcasting its &ldquo;I&rsquo;m alive!&rdquo; signal.</p><p><strong>Third observation:</strong> Home Assistant immediately detected it and showed the roof window entity as available.</p><p>I walked back to the laptop with the Home Assistant dashboard, and pressed the &ldquo;Open&rdquo; button.</p><p><em>The window opened.</em></p><p>Three months of work, and it just&mldr; worked. First try. No debugging. No troubleshooting. I was almost disappointed by the lack of drama.</p><lite-youtube videoid=Wrm5FTS1AHI playlabel=Wrm5FTS1AHI params></lite-youtube><p>The final touch was making it look professional. The Shelly <em>almost</em> fit into the remaining empty space in the control box. After removing the box&rsquo;s sliding cover, the Shelly nestled perfectly into the available space. A bit of Gaffer Tape to act as new cover, and it almost looked like it belonged there.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="final installation" srcset="/posts/iot2-window/featured_hu_6ed578781892d521.webp 330w,
/posts/iot2-window/featured_hu_18123fbcaf9e9845.webp 660w,
/posts/iot2-window/featured_hu_b93378cf1038fc7e.webp 1280w" data-zoom-src=/posts/iot2-window/featured.webp src=/posts/iot2-window/featured.webp></figure></p><h2 class="relative group">The Configuration<div id=the-configuration class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-configuration aria-label=Anchor>#</a></span></h2><p>The final ESPHome configuration ended up just a little bit messier than my initial test (due to the message mapping), but still surprisingly simple:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>esphome</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>roof-window-office</span>
</span></span><span style=display:flex><span><span style=color:#f92672>esp8266</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>board</span>: <span style=color:#ae81ff>esp01_1m</span>
</span></span><span style=display:flex><span><span style=color:#f92672>logger</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>level</span>: <span style=color:#ae81ff>DEBUG</span>
</span></span><span style=display:flex><span><span style=color:#f92672>ota</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>password</span>: <span style=color:#ae81ff>&lt;OTA_PASSWORD&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>api</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>password</span>: <span style=color:#ae81ff>&lt;API_PASSWORD&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>wifi</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ssid</span>:  <span style=color:#ae81ff>&lt;WIFI_PASSWORD&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>password</span>:  <span style=color:#ae81ff>&lt;WIFI_PASSWORD&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>fast_connect</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>globals</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>skip_once</span> <span style=color:#75715e># to account for the echoing of the messages on the bus</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>bool</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restore_value</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>uart</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>id</span>: <span style=color:#ae81ff>data_bus</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>tx_pin</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>number</span>: <span style=color:#ae81ff>GPIO15</span> <span style=color:#75715e># optocoupler</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>inverted</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>rx_pin</span>:  
</span></span><span style=display:flex><span>    <span style=color:#f92672>number</span>: <span style=color:#ae81ff>GPIO5</span> <span style=color:#75715e># zener</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>mode</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>input</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>pullup</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>baud_rate</span>: <span style=color:#ae81ff>5924</span> <span style=color:#75715e># so cursed</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>debug</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>direction</span>: <span style=color:#ae81ff>BOTH</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>dummy_receiver</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>after</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>timeout</span>: <span style=color:#ae81ff>100ms</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>sequence</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>lambda</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          UARTDebug::log_hex(direction, bytes, &#39;-&#39;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          if (direction != UART_DIRECTION_RX) { // dont forget this, you will get an infinite loop otherwise
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            return;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          int32_t message = 0;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          if (bytes.size() != 24) return;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          for (int i=0; i&lt;24; i++){
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            if (bytes[i] &gt; 0xB0) {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              message = (message &lt;&lt; 1) + 1;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            } else {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              message = (message &lt;&lt; 1);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          switch(message){
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            case 0b010101111101010101111101: //M1 Open All
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            case 0b010101111101000011111110: //M1 Open 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              id(skip_once) = true;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              auto call = id(window).make_call();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              call.set_command_open();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              call.perform();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              break;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            case 0b010101101111010101101111: //M1 Close All
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            case 0b010101101111000011111110: //M1 Close 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            { //M1 Close All
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              id(skip_once) = true;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              auto call = id(window).make_call();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              call.set_command_close();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              call.perform();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              break;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            case 0b010110011111010110011111: //M1 Stop All
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            case 0b010110011111000011111110: //M1 Stop 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              id(skip_once) = true;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              auto call = id(window).make_call();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              call.set_command_stop();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              call.perform();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              break;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          }</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>cover</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>time_based</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>id</span>: <span style=color:#ae81ff>window</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>window</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Roof Window&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>assumed_state</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>has_built_in_endstop</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>open_duration</span>: <span style=color:#ae81ff>31s</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>open_action</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>then</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>lambda</span>: |-<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            if (id(skip_once)) {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              id(skip_once) = false;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              return;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            //                   010101                              111101                              010101                              111101
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            static uint8_t msg[]{0x80, 0xFC, 0x80, 0xFC, 0x80, 0xFC, 0xFC, 0xFC, 0xFC, 0xFC, 0x80, 0xFC, 0x80, 0xFC, 0x80, 0xFC, 0x80, 0xFC, 0xFC, 0xFC, 0xFC, 0xFC, 0x80, 0xFC};
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            id(data_bus).write_array(msg, sizeof(msg));</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>close_duration</span>: <span style=color:#ae81ff>31s</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>close_action</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>then</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>lambda</span>: |-<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            if (id(skip_once)) {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              id(skip_once) = false;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              return;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            //                   010101                              101111                              010101                              101111
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            static uint8_t msg[]{0x80, 0xFC, 0x80, 0xFC, 0x80, 0xFC, 0xFC, 0x80, 0xFC, 0xFC, 0xFC, 0xFC, 0x80, 0xFC, 0x80, 0xFC, 0x80, 0xFC, 0xFC, 0x80, 0xFC, 0xFC, 0xFC, 0xFC};
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            id(data_bus).write_array(msg, sizeof(msg));</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>stop_action</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>then</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>lambda</span>: |-<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            if (id(skip_once)) {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              id(skip_once) = false;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              return;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            //                   010110                              011111                              010110                              011111
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            static uint8_t msg[]{0x80, 0xFC, 0x80, 0xFC, 0xFC, 0x80, 0x80, 0xFC, 0xFC, 0xFC, 0xFC, 0xFC, 0x80, 0xFC, 0x80, 0xFC, 0xFC, 0x80, 0x80, 0xFC, 0xFC, 0xFC, 0xFC, 0xFC};
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            id(data_bus).write_array(msg, sizeof(msg));</span>
</span></span></code></pre></div><h2 class="relative group">The Verdict<div id=the-verdict class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#the-verdict aria-label=Anchor>#</a></span></h2><p><strong>Investment:</strong></p><ul><li>Shelly Uni: 12€</li><li>Logic analyzer: 12€</li><li>Replacement Serial Adapter: 7€</li><li>Various components and cables: 20€</li><li>1.27mm pitch adapter: 8€</li><li>Time invested: An unspecified amount of evenings</li><li>Ladder-related near-death experiences: 4</li><li>Professional dignity lost: All of it</li></ul><p>Was the time invested worth it? Absolutely not.<br>Would I do it again? Already planning the next stupid automation.</p><p>Because there&rsquo;s something magical about sitting at your desk on a hot summer night, looking up through your roof window at the stars, and knowing that you can close it with a voice command. Even more if that voice command triggers a Home Assistant automation that sends an API call to an ESPHome device that pretends to be a UART device at 5924 baud, sending commands into a proprietary bus through an optocoupler and reading responses through a Zener diode from a circuit board that was probably designed before I was born.</p><hr><p><em>This is Part 2 of my &ldquo;Stories from the Open Source Smart Home&rdquo; series. No warranties were voided, no windows were bricked (miraculously), and my landlord - who I&rsquo;m still close with - found the whole thing pretty funny when I showed it to her. The system was carefully removed when I moved out, leaving no trace except for one tiny extra VCC wire that nobody will ever notice.</em></p></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt="Emanuel Mairoll" src=/img/author_hu_17fff41dbcaade56.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Emanuel Mairoll</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Forward & Reverse Engineer</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/rolbk/ target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/rolbk/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:sigmoid_flavors_0u@icloud.com target=_blank aria-label=Envelope rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5.0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4.0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4.0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3.0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8.0L0 176z"/></svg></span></span></a></div></div></div></div><div class=mb-10></div><details class="mt-2 mb-5 overflow-hidden rounded-lg ltr:ml-0 ltr:pl-5 rtl:mr-0 rtl:pr-5"><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">The Open Source Smart Home -
This article is part of a series.</summary><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=/posts/iot1-sofa/>Part 1:
The Internet of Furniture</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">Part 2:
This Article</div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=/posts/iot3-door/>Part 3:
The Internet of Entrance Doors</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=/posts/iot4-heislberg/>Part 4:
Heislberg: The Internet of Toilets</a></div></details></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/iot2-window/index.md data-oid-likes=likes_posts/iot2-window/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/iot1-sofa/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">The Internet of Furniture</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2022-05-22T00:00:00+00:00>22 May 2022</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/posts/iot3-door/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">The Internet of Entrance Doors</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2023-08-12T00:00:00+00:00>12 August 2023</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/acknowledgements/ title=Acknowledgements>Acknowledgements</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/privacy/ title="Privacy Statement">Privacy</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/polyring/ title=Polyring>Polyring</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Emanuel Mairoll</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://rolbk.com/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>